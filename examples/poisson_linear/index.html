<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Linear Poisson equation · Bramble.jl</title><meta name="title" content="Linear Poisson equation · Bramble.jl"/><meta property="og:title" content="Linear Poisson equation · Bramble.jl"/><meta property="twitter:title" content="Linear Poisson equation · Bramble.jl"/><meta name="description" content="Documentation for Bramble.jl."/><meta property="og:description" content="Documentation for Bramble.jl."/><meta property="twitter:description" content="Documentation for Bramble.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Bramble.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Bramble.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Linear Poisson equation</a><ul class="internal"><li><a class="tocitem" href="#Problem-description"><span>Problem description</span></a></li><li><a class="tocitem" href="#Discretization"><span>Discretization</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li></ul></li><li><a class="tocitem" href="../poisson_nonlinear/">Nonlinear Poisson equation</a></li></ul></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../../api/">API</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Internals</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../internals/utils/">Utilities</a></li><li><a class="tocitem" href="../../internals/geometry/">Geometry</a></li><li><a class="tocitem" href="../../internals/mesh/">Mesh</a></li><li><a class="tocitem" href="../../internals/space/">Spaces</a></li><li><a class="tocitem" href="../../internals/form/">Forms</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Linear Poisson equation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Linear Poisson equation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/gpena/Bramble.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/gpena/Bramble.jl/blob/main/docs/src/examples/poisson_linear.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Linear-Poisson-equation"><a class="docs-heading-anchor" href="#Linear-Poisson-equation">Linear Poisson equation</a><a id="Linear-Poisson-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-Poisson-equation" title="Permalink"></a></h1><p>In this section, we&#39;ll demonstrate how to utilize <code>Bramble.jl</code> to solve a linear Poisson equation with Dirichlet boundary conditions.</p><hr/><h2 id="Problem-description"><a class="docs-heading-anchor" href="#Problem-description">Problem description</a><a id="Problem-description-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-description" title="Permalink"></a></h2><p>Let&#39;s consider the following Poisson equation on a <span>$n$</span>-dimensional square domain (<span>$n=1,2,3$</span>),</p><p class="math-container">\[\begin{align*}
- \Delta u (x) &amp;= f(x), \, x \in \Omega \\
u(x) &amp;= g(x), \, x \in \partial \Omega
\end{align*}\]</p><p>where <span>$\Omega = (a,b)^n$</span>.</p><p>In order to have a working example of our Poisson problem we aim to solve, lets take <span>$n=2$</span> and define</p><p class="math-container">\[u(x,y) = e^{x + y}, \, (x,y) \in [0,1]^2\]</p><p>and calculate <span>$f$</span> and <span>$g$</span> accordingly.</p><h2 id="Discretization"><a class="docs-heading-anchor" href="#Discretization">Discretization</a><a id="Discretization-1"></a><a class="docs-heading-anchor-permalink" href="#Discretization" title="Permalink"></a></h2><p>The former problem can be discretized with finite differences based on a nonuniform grid. We will now detail the mathematical tools needed to formalize our discretization method.</p><p>Let us denote by <span>$\Lambda$</span> a sequence of vectors <span>$h=(h_{x_1}, h_{x_2})$</span>, where <span>$h_x = (h_{x,1}, h_{x,2}, \dots, h_{x,N_x})$</span>, <span>$h_y = (h_{y,1}, h_{y,2}, \dots, h_{y,N_y})$</span> and <span>$h_{x,j}, h_{y,j} &gt;0$</span>. Let us denote by <span>$h_{max}$</span> the maximum over all values of <span>$h_{x,j}$</span> and <span>$h_{y,j}$</span>.</p><p>For each <span>$h \in \Lambda$</span>, we define the grid space</p><p class="math-container">\[\overline{\Omega}_h = \set{(x_i, y_j) \in \mathbb{R}^2: x_0 = y_0 = 0, x_i = x_{i-1} + h_{x,i}, i=1,\dots,N_x,  y_j = x_{j-1} + h_{y,j}, j=1,\dots,N_y }.\]</p><p>We also denote by <span>$\partial \overline{\Omega}_h$</span>, the subset of grid points corresponding to the boundary <span>$\partial \Omega$</span>. Built upon these grids, we introduce the discrete spaces of grid functions</p><p class="math-container">\[W_h(\overline{\Omega}_h) = \set{u_h: \overline{\Omega}_h \longrightarrow \mathbb{R}}\]</p><p>as well as <span>$W_{h,0}(\overline{\Omega}_h) \subseteq W_h(\overline{\Omega}_h)$</span>, its subspace of functions that take zero values at the boundary.</p><p>Finally, we introduce some notations for functions <span>$u_h$</span> and <span>$v_h$</span> in <span>$W_h(\overline{\Omega}\_h)$</span></p><p class="math-container">\[(u_h,v_h)_h = \sum_{i=1}^{N_x}\sum_{j=1}^{N_y} |\square_{i,j}| u_h(x_i, y_j) v_h(x_i,y_j),\]</p><p class="math-container">\[(u_h,v_h)_{+x} = \sum_{i=1}^{N_x}\sum_{j=1}^{N_y-1} h_{x,i} h_{y,j+1/2} u_h(x_i, y_j) v_h(x_i,y_j)\]</p><p class="math-container">\[(u_h,v_h)_{+y} = \sum_{i=1}^{N_x-1}\sum_{j=1}^{N_y} h_{x,i+1/2} h_{y,j} u_h(x_i, y_j) v_h(x_i,y_j)\]</p><p>where <span>$\square_{i,j} = \left[x_i-\frac{h_{x,i}}{2}, x_i+\frac{h_{x,i+1}}{2} \right] \times \left[y_j-\frac{h_{y,j}}{2}, y_j+\frac{h_{y,j+1}}{2} \right]$</span>, <span>$|\square_{i,j}|$</span> is its area and <span>$h_{\cdot,i+1/2} = \frac{h_{\cdot,i}-h_{\cdot,i+1}}{2}$</span>.</p><p>If <span>$D_{-x}$</span> and <span>$D_{-y}$</span> denote the standard backward difference operators defined on the grid points of <span>$\overline{\Omega}_h$</span>, then, we can formulate the following discrete problem:</p><blockquote><p>find <span>$u_h \in W_h(\overline{\Omega}_h)$</span>, with <span>$u_h(x_i,y_j) = u(x_i,y_j)$</span> on <span>$\partial \overline{\Omega}_h$</span>, such that</p><p class="math-container">\[(D_{-x}u_h, D_{-x}v_h)_{+x} + (D_{-y}u_h, D_{-y}u_h)_{+y} = ((g)_h, v_h)_h, \, \forall  v_h  \in W_{h,0}(\overline{\Omega}_h).\]</p></blockquote><p>Here, the <span>$(\cdot)_h$</span> operator is defined as follows</p><p class="math-container">\[(g)_h (x_i,y_j) = \frac{1}{|\square_{ij}|} \iint_{\square_{ij}} g(x)\, dxdy.\]</p><p>This defines a discretization that can be seen both as a finite difference and finite element method. It can be shown that under certain smoothness assumptions on <code>f</code> and <code>g</code>, the former problem has a unique solution <span>$u_h$</span> such that</p><p class="math-container">\[\Vert R_h u - u_h \Vert_{1h} \leq C h_{max}^ 2,\]</p><p>where</p><p class="math-container">\[\Vert v_h \Vert_{1h} = \sqrt{\Vert v_h \Vert_{h}^2 + \Vert D_{-x} v_h \Vert_{h,x}^2 + \Vert D_{y} v_h \Vert_{h,y}^2}\]</p><p>and</p><p class="math-container">\[\begin{aligned}
\Vert v_h \Vert_{h} &amp;= \sqrt{(v_h,v_h)_h},\\
 \Vert D_{-x} v_h \Vert_{h,x} &amp;= \sqrt{(D_{-x} v_h, D_{-x} v_h)_{+x}},\\
 \Vert D_{-y} v_h \Vert_{h,y} &amp;= \sqrt{(D_{-y} v_h, D_{-y} v_h)_{+y}}.
 \end{aligned}\]</p><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><p>We can now use <code>Bramble.jl</code> to calculate <span>$u_h$</span>. As with any Julia package, we start by importing <code>Bramble.jl</code> and a few other packages we will need down the line</p><pre><code class="language-julia hljs">using Bramble
using LinearSolve       # solvers for linear systems
using IncompleteLU: ilu # incomplete LU for preconditioning</code></pre><p>We start by building a grid associated with the Poisson equation&#39;s domain, as well as, the solution (to impose Dirichlet boundary conditions) and the equation&#39;s right hand side <span>$g$</span>.</p><pre><code class="language-julia hljs">I = interval(0, 1)
X = I × I
Ω = domain(X)
Ωₕ = mesh(Ω, (10, 20), (true, false))</code></pre><p>The first three lines create a <a href="../../internals/geometry/#Bramble.Domain">Domain</a> object, while the third generates a mesh with 10 and 20 points along the <span>$x$</span> and <span>$y$</span> directions, respectively. The last input argument encodes that we want a uniform grid in the <span>$x$</span> axis and random generated points in the <span>$y$</span> axis.</p><p>We now move on to define the Dirichlet constraints associated with that condition. We impose the expression of the exact solution to the whole domain boundary:</p><pre><code class="language-julia hljs">bcs = dirichlet_constraints(set(Ω), :boundary =&gt; x -&gt; sol(x))</code></pre><p>We now build the gridspace and define the <code>linear</code> and <code>bilinear</code> forms associated with the discrete variational problem presented. We create the discrete space with</p><pre><code class="language-julia hljs">Wₕ = gridspace(Ωₕ)</code></pre><p>and move on to define the bilinear form and assembling the associated matrix</p><pre><code class="language-julia hljs">aₕ = form(Wₕ, Wₕ, (Uₕ, Vₕ) -&gt; inner₊(∇₋ₕ(Uₕ), ∇₋ₕ(Vₕ)))
A = assemble(aₕ, dirichlet_labels = :boundary)</code></pre><p>In this case, we provide to the <code>assemble</code> function the information on boundary conditions in order to have this information encoded in matrix <code>A</code>.</p><p>Next, we create an <a href="../../internals/space/#Bramble.VectorElement">VectorElement</a> in the gridspace whose components are calculated by the averaging operator <a href="../../api/#Bramble.avgₕ">avgₕ</a></p><pre><code class="language-julia hljs">uₕ = element(Wₕ)
avgₕ!(uₕ, rhs)</code></pre><p>We now define the linear forms associated with the right hand side</p><pre><code class="language-julia hljs">lₕ = form(Wₕ, vₕ -&gt; innerₕ(uₕ, vₕ))
F = assemble(lₕ, bcs, dirichlet_labels = :boundary)</code></pre><p>and assemble vector <code>F</code>. The solution of the linear system <code>Ax=F</code> will provide the components of vector <code>uₕ</code>, solution of the discrete variational problem. To solve the system, we use GMRES (package <a href="https://github.com/SciML/LinearSolve.jl">LinearSolve.jl</a>) preconditioned with an incomplete LU factorization as precondition (package <a href="https://github.com/haampie/IncompleteLU.jl">incompleteLU.jl</a>)</p><pre><code class="language-julia hljs">prec = ilu(A, τ = 0.001)
prob = LinearProblem(A, F)
solₕ = solve(prob, KrylovJL_GMRES(), Pl = prec, verbose = false)
uₕ .= solₕ.u</code></pre><p>and calculate the solution. If we want to calculate the error associated with this approximate solution (w.r.t <a href="../../api/#Bramble.normₕ">norm₁ₕ</a>), we can follow with</p><pre><code class="language-julia hljs">F .= uₕ
Rₕ!(uₕ, sol)
uₕ .-= F

norm₁ₕ(uₕ)</code></pre><p>We can even use <a href="https://github.com/JuliaPlots/GLMakie.jl">GLMakie</a> to plot the solution</p><pre><code class="language-julia hljs">using GLMakie

x = points(Ωₕ(1))
y = points(Ωₕ(2))

reshaped_uₕ = reshape(uₕ, 10, 20)

fig = Figure(size = (1200, 800))
ax1 = Axis(fig[1, 1], aspect = 1)
ax2 = Axis3(fig[1, 2], aspect = (1, 1, 1),
      perspectiveness = 0.5,
      elevation = π / 3.5,
      azimuth = 0.1π)

wireframe!(ax1, x, y, reshaped_uₕ) # mesh plot
surface!(ax2, x, y, reshaped_uₕ)   # solution plot</code></pre><p><img src="../../assets/examples/poisson_linear.png" alt="Mesh and approximate solution plots with GLMakie"/></p><p>or export it to a <code>vtk</code> format to visualize, for instance, with <a href="https://www.paraview.org/">Paraview</a>.</p><pre><code class="language-julia hljs">export_file = &quot;surf&quot;
vtk_grid(export_file, x, y, z) do vtk
    vtk[&quot;poisson&quot;] = vis_uₕ
end

vtk_save(vtk)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../poisson_nonlinear/">Nonlinear Poisson equation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Wednesday 29 October 2025 12:21">Wednesday 29 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
